"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[167],{749:(e,t,s)=>{s.d(t,{s:()=>r});s(65043);var n=s(62582),a=s(70579);function r(){let e={padding:"3px"};return(0,a.jsx)("div",{children:(0,a.jsxs)("div",{style:{paddingTop:"8px",display:"flex",flexWrap:"wrap"},children:[(0,a.jsx)("div",{style:e,children:(0,a.jsxs)(n.N_,{to:"/pages/attendanceregs/myregisters",children:["  ",(0,a.jsxs)("div",{class:"button1",children:[(0,a.jsx)("span",{class:"fa fa-list"})," My registers"]})]})}),(0,a.jsx)("div",{style:e,children:(0,a.jsx)(n.N_,{to:"/pages/attendanceregs/createattendanceregister",children:(0,a.jsx)("div",{class:"button1",children:(0,a.jsxs)("span",{children:[(0,a.jsx)("span",{class:"fa fa-plus"})," New register"]})})})})]})})}},30167:(e,t,s)=>{s.r(t),s.d(t,{SendSms:()=>l,default:()=>g});var n=s(65043),a=s(78407),r=s(35407),c=s(35323),o=(s(749),s(76273)),i=s(62582),d=s(70579);function l(){let e=(0,c.g)();const[t,s]=(0,n.useState)(""),[l]=(0,r.lT)(["user"]),[g,m]=(0,n.useState)(""),[h,p]=(0,n.useState)(""),[u,x]=(0,n.useState)("");const[j,y]=(0,n.useState)(""),[S,f]=(0,n.useState)(""),[v,A]=(0,n.useState)([]),[b,C]=(0,n.useState)(""),[w,I]=(0,n.useState)(""),[T,k]=(0,n.useState)("10000"),[B,R]=(0,n.useState)("10000"),[E,F]=(0,n.useState)("100"),[N,O]=(0,n.useState)(""),[D,M]=(0,n.useState)(""),[W,K]=(0,n.useState)(""),[_,z]=(0,n.useState)(""),[J,L]=(0,n.useState)("calculating......"),[P,Q]=(0,n.useState)(""),[U,V]=(0,n.useState)(""),[Y,q]=(0,n.useState)(""),[G,H]=(0,n.useState)(""),[X,Z]=(0,n.useState)(""),[$,ee]=(0,n.useState)(""),[te,se]=(0,n.useState)("");const[ne,ae]=(0,n.useState)(1);function re(e){let t=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],s=1;return t.reverse(),t.forEach(t=>{e<150*t+1&&(s=t)}),s}"whatsapp://send?text=*".concat(_,"*%0A%0ATap link below to register:%0A").concat(o.J_,"/pages/attendanceregs/").concat(e.registrar,"/").concat(e.id,"%0A%0A*Thank you.*");return(0,n.useEffect)(()=>{window.location.href="#",fetch("/attendanceregs/".concat(e.registrarContact,"/").concat(e.registerId)).then(e=>e.json()).then(t=>{0===t.presence?(z("This Register does not exist. Please try another or create your own register too for free"),y("Kayas 0703852178-WhatsApp")):(y(t.name),K(t.institution),z("".concat(t.registerTitle)),M(t.contact),fetch("/attendeesMessage/".concat(e.registrarContact,"/").concat(e.registerId)).then(e=>e.json()).then(e=>{q(e.smsUnitCost);let t=e.smsUnitCost;V(re(Array.from(e.smsmessage).length)),Q(Array.from(e.smsmessage).length),document.getElementById("setAttendeeRegisterSmsForm").smsmessage.value=e.smsmessage,H(re(Array.from(document.getElementById("setAttendeeRegisterSmsForm").smsmessage.value).length)*t*e.attendees.length)}))}),fetch("/attendees/".concat(e.registrarContact,"/").concat(e.registerId)).then(e=>e.json()).then(e=>{f(e.registerDoc.attendees.length),A(e.registerDoc.attendees),Z(30*e.registerDoc.attendees.length)}),fetch("/getTradingDetails/".concat(e.registrarContact)).then(e=>e.json()).then(e=>{L(e[0].accBal),p(e[0].permissionTokensObj.sendSmsTokens),0==e[0].permissionTokensObj.sendSmsWithoutTag?ee('The tag "#KayasSMS" will automatically be appended at the end of the SMS'):ee("")})},[]),(0,d.jsx)("div",{style:{padding:"3px"},children:(0,d.jsxs)("div",{class:"row",children:[(0,d.jsx)("div",{class:"col-md-3"}),(0,d.jsxs)("div",{class:"col-md-6",style:{padding:"15px"},children:[(0,d.jsxs)("div",{class:"pageLabel",children:["Send SMS to: ",_]}),(0,d.jsxs)("div",{style:{paddingBottom:"8px"},children:["Contacts: ",S]}),(0,d.jsxs)("form",{id:"setAttendeeRegisterSmsForm",children:[(0,d.jsxs)("div",{class:"mb-3",children:[(0,d.jsx)("input",{type:"hidden",class:"form-control",autoComplete:"off",name:"contact",defaultValue:D}),(0,d.jsxs)("div",{style:{fontSize:""},children:[(0,d.jsxs)("div",{children:["Between 0 - 150 message characters: ","".concat(X," shs")]}),(0,d.jsxs)("div",{children:["Between 151 - 300 message characters: ","".concat(2*X," shs"),"."]}),(0,d.jsxs)("div",{children:["Between 301 - 450 message characters: ","".concat(3*X," shs")]}),(0,d.jsxs)("div",{children:["Between 451 - 600 message characters: ","".concat(4*X," shs")]})]}),(0,d.jsx)("p",{}),(0,d.jsx)("div",{class:"bold",children:"Type message:"}),(0,d.jsxs)("div",{class:"row",children:[(0,d.jsxs)("div",{class:"col-8",children:[" Number of typed message characters: ",(0,d.jsx)("span",{style:{color:"red"},children:P})]}),(0,d.jsx)("div",{class:"col-4",children:(0,d.jsx)("div",{class:"btn btn-danger btn-sm",onClick:()=>{document.getElementById("setAttendeeRegisterSmsForm").smsmessage.value=""},children:"Clear message"})})]}),(0,d.jsx)("p",{}),(0,d.jsxs)("div",{style:{textAlign:"left",fontSize:"20px"},children:["Cost: ",(0,d.jsxs)("span",{style:{color:"red"},children:[G," Shs"]})," "]}),(0,d.jsx)("textarea",{rows:"10",type:"text",class:"form-control",autoComplete:"off",name:"smsmessage",onChange:()=>{Q(Array.from(document.getElementById("setAttendeeRegisterSmsForm").smsmessage.value.trim()).length),V(re(Array.from(document.getElementById("setAttendeeRegisterSmsForm").smsmessage.value.trim()).length)),H(re(Array.from(document.getElementById("setAttendeeRegisterSmsForm").smsmessage.value.trim()).length)*Y*S)}}),(0,d.jsx)("div",{style:{paddingTop:"10px"},class:"bold",children:$})]}),(0,d.jsx)("div",{style:{fontSize:"12px"}}),(0,d.jsx)("div",{style:{padding:"5px"},children:(0,d.jsxs)("div",{onClick:()=>{1==(0,a.Qb)(l)&&(parseInt(J)<parseInt(G)?(0,a.yd)("toastAlert2","Low account balance. Contact Kayas 0703852178",6e3):!0===window.confirm("Press OK to confirm")&&((0,a.yd)("toastAlert1","Sending. Wait for confirmation message.....",5e3),fetch("/getTradingDetails/".concat(e.registrarContact)).then(e=>e.json()).then(t=>{let s=t[0],n=document.getElementById("setAttendeeRegisterSmsForm").smsmessage.value;0==s.permissionTokensObj.sendSmsWithoutTag&&(n+=" #KayasSMS"),fetch("/sendAttendeeRegisterSms",{method:"post",headers:{"Content-type":"application/json"},body:JSON.stringify({registrarContact:parseInt(l.user.contact),smsmessage:n,registerId:parseInt(e.registerId),smsCost:G})}).then(e=>e.json()).then(t=>{(0,a.yd)("toastAlert1","".concat(t[0]),4e3),fetch("/getTradingDetails/".concat(e.registrarContact)).then(e=>e.json()).then(e=>{L(e[0].accBal),p(e[0].permissionTokensObj.sendSmsTokens)})})})))},type:"text",style:{width:"100%"},class:"btn btn-success",children:["Send ",(0,d.jsx)("span",{class:"fa fa-paper-plane"})]})}),(0,d.jsxs)("div",{style:{display:"flex",flexWrap:"wrap"},children:[(0,d.jsx)("div",{style:{padding:"5px"},children:(0,d.jsx)("div",{onClick:()=>{1==(0,a.Qb)(l)&&(parseInt(l.user.contact)!=parseInt(e.registrarContact)?(0,a.yd)("toastAlert2","Not allowed. You do not own this contacts register",3e3):((0,a.yd)("toastAlert1","Setting, please wait......",3e3),fetch("/setAttendeeRegisterSms",{method:"post",headers:{"Content-type":"application/json"},body:JSON.stringify({registrarContact:parseInt(l.user.contact),smsmessage:document.getElementById("setAttendeeRegisterSmsForm").smsmessage.value,registerId:parseInt(e.registerId)})}).then(e=>e.json()).then(e=>{(0,a.yd)("toastAlert1","".concat(e[0]),3e3)})))},type:"text",class:"button1",children:"Save message"})}),(0,d.jsx)("div",{style:{padding:"5px"},children:(0,d.jsx)(i.N_,{to:"/pages/attendanceregs/".concat(parseInt(e.registrarContact),"/").concat(e.registerId),children:(0,d.jsx)("div",{type:"text",class:"button1",children:"Back to register"})})})]})]})]}),(0,d.jsx)("div",{class:"col-md-3"})]})})}const g=l}}]);
//# sourceMappingURL=167.d222c944.chunk.js.map