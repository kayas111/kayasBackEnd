"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[250],{4250:(e,t,i)=>{i.r(t),i.d(t,{CreateArticle:()=>u,default:()=>h});var a=i(7638),r=i(8289),o=i(9978),s=i(5407),l=(i(7890),i(5043)),n=i(7977),c=i(8345),d=i.n(c),m=i(579);r.A.initializeApp({apiKey:"AIzaSyCf0LC-eL1pJ2Rpvh59ukbg5OUFm6IcrEA",authDomain:"kayas-42321.firebaseapp.com",projectId:"kayas-42321",storageBucket:"kayas-42321.appspot.com"});const p=r.A.storage().ref();function u(){const[e,t,i]=(0,s.lT)(["user"]),[r,c]=(0,l.useState)(""),[u,h]=(0,l.useState)(""),[g,y]=(0,l.useState)(0),[f,b]=(0,l.useState)("Image appears here");function v(){c("<div style='color:orange;'>Initializing.........</div>"),setTimeout((()=>{c("<div style='color:orange;'>Gathering requirements.................</div>"),setTimeout((()=>{c("<div style='color:orange;'>Creating...........................</div>")}),5e3)}),5e3),fetch("/getTradingDetails/".concat(parseInt(e.user.contact))).then((e=>e.json())).then((e=>{let t=e[0];t.permissionTokensObj.createPubArticleTokens<1||t.permissionTokensObj.createPubArticleTokens>1?fetch("/createArticle",{method:"post",headers:{"Content-type":"application/json"},body:JSON.stringify({headline1:document.getElementById("articleCreateForm")[0].value.trim(),institution:t.institution.trim(),author:t.name.trim(),contact:parseInt(t.contact),body:u.trim()})}).then((e=>e.json())).then((e=>{let t=e;if(1===e.limitReached)(0,a.yd)("toastAlert2","Maximum number of articles reached. Delete some",5e3);else{let i=document.querySelector("#pubArticleImageInputElement").files[0];if(document.getElementById("articleCreateForm").articleHeadline1.value="",void 0===i)window.location.href="/pages/pubarticles/article/".concat(e.id),(0,a.yd)("toastAlert1","Finalizing......",5e3);else{let r=0;setInterval((()=>{94!==r&&(r+=1,y(r))}),450),c("<div style='color:orange;'>Uploading image..........</div>");let o="pubArticleImage_".concat(t.id),s=p.child("pubArticleImages/".concat(o));s.put(i).then((i=>{s.getDownloadURL({orderBy:"generation",limitTo:1}).then((i=>{let r=i;fetch("/addPubArticleImageUrlToArticle",{method:"post",headers:{"Content-type":"application/json"},body:JSON.stringify({contact:parseInt(t.contact),articleId:t.id,imageDownLoadUrl:r})}).then((t=>{c("<div style='color:orange;'>Image saved</div>"),window.location.href="/pages/pubarticles/article/".concat(e.id),(0,a.yd)("toastAlert1","Finalizing......",5e3)}))}))}))}}})):0===t.permissionTokensObj.createPubArticleTokens?(0,a.yd)("toastAlert2","Maximum number of articles reached. Delete some",4e3):(0,a.yd)("toastAlert2","Error, try again",3e3)}))}return(0,l.useEffect)((()=>{(0,a.Qb)(e)}),[]),(0,m.jsx)("div",{children:(0,m.jsxs)("div",{className:"row",children:[(0,m.jsx)("div",{class:"col-md-3"}),(0,m.jsxs)("div",{class:"col-md-6",children:[(0,m.jsx)(o.dV,{}),(0,m.jsx)("div",{style:{padding:"8px"},children:(0,m.jsxs)("form",{method:"post",id:"articleCreateForm",action:"#",children:[(0,m.jsx)("div",{style:{paddingBottom:"8px"},children:(0,m.jsx)("div",{class:"formLabel",children:"Create article."})}),(0,m.jsxs)("div",{class:"mb-3",children:[(0,m.jsx)("div",{class:"formInputLabel",children:"Type headline"}),(0,m.jsx)("textarea",{rows:"3",type:"text",class:"form-control",autoComplete:"off",name:"articleHeadline1"}),(0,m.jsx)("br",{}),(0,m.jsxs)("div",{class:"formInputLabel",children:["Add photo ",(0,m.jsxs)("span",{style:{fontSize:"12px"},children:[" ",(0,m.jsx)("input",{type:"file",id:"pubArticleImageInputElement",name:"file",onChange:e=>{let t=document.querySelector("#pubArticleImageInputElement").files[0],i=Array.from(t.type);"i"===i[0]&&"m"===i[1]&&"a"===i[2]&&"g"===i[3]&&"e"===i[4]?b(URL.createObjectURL(t)):((0,a.yd)("toastAlert2","Image format ".concat(t.type," not supported. Change image"),5e3),setTimeout((()=>{window.location.href="/pages/pubarticles/createarticle"}),5e3))}})]})]}),(0,m.jsx)("div",{style:{paddingTop:"4px"},children:(0,m.jsx)("img",{src:f,class:" d-block w-100",alt:""})}),(0,m.jsx)("br",{}),(0,m.jsx)("div",{class:"formInputLabel",children:"Type/Paste your message here:"}),(0,m.jsx)(n.CKEditor,{config:{toolbar:["Bold","Italic","Link","NumberedList","BulletedList"]},editor:d(),onChange:(e,t)=>{const i=t.getData();h(i)}})]}),(0,m.jsx)("div",{style:{fontSize:"15px",fontWeight:"600"},dangerouslySetInnerHTML:{__html:r}}),(0,m.jsx)("progress",{value:g,max:"100",style:{width:"100%",color:"red"}}),(0,m.jsx)("div",{onClick:()=>{if(Array.from(document.getElementById("articleCreateForm").articleHeadline1.value.trim()).length<1)(0,a.yd)("toastAlert2","Enter a headline",3e3);else if(Array.from(u).length<1){void 0===document.querySelector("#pubArticleImageInputElement").files[0]?(0,a.yd)("toastAlert2","Type or paste some information in the body section",3e3):v()}else v()},class:"form-submit-btn backgroundColorHovereffect",children:"Create Article"}),(0,m.jsx)("p",{})]})})]}),(0,m.jsx)("div",{class:"col-md-3"})]})})}const h=u}}]);
//# sourceMappingURL=250.67821a45.chunk.js.map