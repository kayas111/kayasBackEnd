"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[167],{749:(e,t,s)=>{s.d(t,{s:()=>a});s(65043);var n=s(70579);function a(){let e={padding:"3px"};return(0,n.jsx)("div",{children:(0,n.jsxs)("div",{style:{paddingTop:"8px",display:"flex",flexWrap:"wrap"},children:[(0,n.jsx)("div",{style:e,children:(0,n.jsx)("a",{href:"/pages/attendanceregs/createattendanceregister",children:(0,n.jsx)("div",{class:"button1",children:(0,n.jsxs)("span",{children:[(0,n.jsx)("span",{class:"fa fa-plus"})," Create register"]})})})}),(0,n.jsx)("div",{style:e,children:(0,n.jsx)("a",{href:"/pages/attendanceregs/myregisters",children:(0,n.jsxs)("div",{class:"button1",children:[(0,n.jsx)("span",{class:"fa fa-list"})," My registers"]})})})]})})}},30167:(e,t,s)=>{s.r(t),s.d(t,{SendSms:()=>g,default:()=>m});var n=s(65043),a=s(87638),r=s(35407),c=s(35323),o=s(749),i=s(76273),d=s(62582),l=s(70579);function g(){let e=(0,c.g)();const[t,s]=(0,n.useState)(""),[g]=(0,r.lT)(["user"]),[m,h]=(0,n.useState)(""),[p,u]=(0,n.useState)(""),[x,S]=(0,n.useState)("");const[j,y]=(0,n.useState)(""),[f,v]=(0,n.useState)(""),[A,C]=(0,n.useState)([]),[I,b]=(0,n.useState)(""),[w,k]=(0,n.useState)(""),[R,B]=(0,n.useState)("10000"),[T,E]=(0,n.useState)("10000"),[F,z]=(0,n.useState)("100"),[M,O]=(0,n.useState)(""),[D,N]=(0,n.useState)(""),[J,K]=(0,n.useState)(""),[L,P]=(0,n.useState)("Please wait......"),[W,Q]=(0,n.useState)("calculating......"),[U,_]=(0,n.useState)(""),[V,Y]=(0,n.useState)(""),[q,G]=(0,n.useState)(""),[H,X]=(0,n.useState)("calculating....."),[Z,$]=(0,n.useState)("");const[ee,te]=(0,n.useState)(1);function se(e){let t=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],s=1;return t.reverse(),t.forEach((t=>{e<150*t+1&&(s=t)})),s}"whatsapp://send?text=*".concat(L,"*%0A%0ATap link below to register:%0A").concat(i.J_,"/pages/attendanceregs/").concat(e.registrar,"/").concat(e.id,"%0A%0A*Thank you.*");return(0,n.useEffect)((()=>{fetch("/attendanceregs/".concat(e.registrarContact,"/").concat(e.registerId)).then((e=>e.json())).then((t=>{0===t.presence?(P("This Register does not exist. Please try another or create your own register too for free"),y("Kayas 0703852178-WhatsApp")):(y(t.name),K(t.institution),P(t.registerTitle),N(t.contact),fetch("/attendeesMessage/".concat(e.registrarContact,"/").concat(e.registerId)).then((e=>e.json())).then((e=>{G(e.smsUnitCost);let t=e.smsUnitCost;Y(se(Array.from(e.smsmessage).length)),_(Array.from(e.smsmessage).length),document.getElementById("setAttendeeRegisterSmsForm").smsmessage.value=e.smsmessage,X(se(Array.from(document.getElementById("setAttendeeRegisterSmsForm").smsmessage.value).length)*t*e.attendees.length)})))})),fetch("/attendees/".concat(e.registrarContact,"/").concat(e.registerId)).then((e=>e.json())).then((e=>{v(e.registerDoc.attendees.length),C(e.registerDoc.attendees)})),fetch("/getTradingDetails/".concat(e.registrarContact)).then((e=>e.json())).then((e=>{Q(e[0].accBal),u(e[0].permissionTokensObj.sendSmsTokens)}))}),[]),(0,l.jsx)("div",{children:(0,l.jsxs)("div",{class:"row",children:[(0,l.jsx)("div",{class:"col-md-3"}),(0,l.jsxs)("div",{class:"col-md-6",style:{padding:"15px"},children:[(0,l.jsx)(o.s,{}),(0,l.jsx)("br",{}),(0,l.jsxs)("form",{id:"setAttendeeRegisterSmsForm",children:[(0,l.jsx)("div",{style:{paddingBottom:"8px"},children:(0,l.jsxs)("div",{class:"formLabel",children:["Send SMS to ",L,(0,l.jsxs)("div",{style:{color:"white"},children:[f," contacts"]})]})}),(0,l.jsxs)("div",{class:"mb-3",children:[(0,l.jsx)("input",{type:"hidden",class:"form-control",autoComplete:"off",name:"contact",defaultValue:D}),(0,l.jsxs)("div",{children:["Account balance: ",(0,l.jsxs)("span",{style:{color:"red",fontSize:"15px"},children:[W,"/="]})]}),(0,l.jsxs)("div",{children:["SMS Rate: ",(0,l.jsx)("span",{style:{fontSize:"15px",color:"red"},children:150})," characters per contact = ",(0,l.jsxs)("span",{style:{fontSize:"15px",color:"red"},children:[q,"/="]})," "]}),(0,l.jsxs)("div",{children:["Cost for ",(0,l.jsx)("span",{style:{fontSize:"15px",color:"red"},children:U})," characters to ",(0,l.jsx)("span",{style:{fontSize:"15px",color:"red"},children:f})," contacts = ",(0,l.jsxs)("span",{style:{fontSize:"15px",color:"red"},children:[H,"/="]})]}),(0,l.jsxs)("div",{children:["Sending times left: ",(0,l.jsx)("span",{style:{color:"red"},children:p})," "]}),(0,l.jsx)("p",{}),(0,l.jsx)("div",{style:{textAlign:"right"},children:(0,l.jsx)("div",{class:"btn btn-sm btn-warning",onClick:()=>{document.getElementById("setAttendeeRegisterSmsForm").smsmessage.value=""},children:"Clear message"})}),(0,l.jsx)("div",{class:"formInputLabel",children:"Enter message"}),(0,l.jsx)("textarea",{rows:"10",type:"text",class:"form-control",autoComplete:"off",name:"smsmessage",onChange:()=>{_(Array.from(document.getElementById("setAttendeeRegisterSmsForm").smsmessage.value.trim()).length),Y(se(Array.from(document.getElementById("setAttendeeRegisterSmsForm").smsmessage.value.trim()).length)),X(se(Array.from(document.getElementById("setAttendeeRegisterSmsForm").smsmessage.value.trim()).length)*q*f)}})]}),(0,l.jsx)("div",{style:{fontSize:"12px"}}),(0,l.jsxs)("div",{style:{display:"flex",flexWrap:"wrap"},children:[(0,l.jsx)("div",{style:{padding:"5px"},children:(0,l.jsx)("div",{onClick:()=>{1==(0,a.Qb)(g)&&(parseInt(g.user.contact)!=parseInt(e.registrarContact)?(0,a.yd)("toastAlert2","Not allowed. You do not own this contacts register",3e3):((0,a.yd)("toastAlert1","Setting, please wait......",3e3),fetch("/setAttendeeRegisterSms",{method:"post",headers:{"Content-type":"application/json"},body:JSON.stringify({registrarContact:parseInt(g.user.contact),smsmessage:document.getElementById("setAttendeeRegisterSmsForm").smsmessage.value,registerId:parseInt(e.registerId)})}).then((e=>e.json())).then((e=>{(0,a.yd)("toastAlert1","".concat(e[0]),3e3)}))))},type:"text",class:"button1",children:"Save SMS"})}),(0,l.jsx)("div",{style:{padding:"5px"},children:(0,l.jsx)("div",{onClick:()=>{1==(0,a.Qb)(g)&&(parseInt(W)<parseInt(H)?(0,a.yd)("toastAlert2","Low account balance. Contact Kayas",3e3):!0===window.confirm("Press OK to confirm")&&((0,a.yd)("toastAlert1","Sending.........",4e3),fetch("/sendAttendeeRegisterSms",{method:"post",headers:{"Content-type":"application/json"},body:JSON.stringify({registrarContact:parseInt(g.user.contact),smsmessage:document.getElementById("setAttendeeRegisterSmsForm").smsmessage.value,registerId:parseInt(e.registerId),smsCost:H})}).then((e=>e.json())).then((t=>{(0,a.yd)("toastAlert1","".concat(t[0]),3e3),fetch("/getTradingDetails/".concat(e.registrarContact)).then((e=>e.json())).then((e=>{Q(e[0].accBal),u(e[0].permissionTokensObj.sendSmsTokens)}))}))))},type:"text",class:"button1",children:"Send SMS"})}),(0,l.jsx)("div",{style:{padding:"5px"},children:(0,l.jsx)(d.N_,{to:"/pages/attendanceregs/".concat(parseInt(e.registrarContact),"/").concat(e.registerId),children:(0,l.jsx)("div",{type:"text",class:"button1",children:"Back to register"})})})]})]})]}),(0,l.jsx)("div",{class:"col-md-3"})]})})}const m=g}}]);
//# sourceMappingURL=167.32edb048.chunk.js.map