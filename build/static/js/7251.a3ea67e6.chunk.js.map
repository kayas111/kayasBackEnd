{"version":3,"file":"static/js/7251.a3ea67e6.chunk.js","mappings":"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","sources":["pages/payments/MakePayment.js"],"sourcesContent":["\r\nimport React, {useEffect,useState} from 'react'\r\nimport { ToastAlert,IsLoggedIn, Post, GetTradingDetails } from '../Functions';\r\nimport {LoginPage} from '../LoginPage'\r\nimport {useCookies} from 'react-cookie'\r\n\r\nexport function MakePayment(){\r\n    const [cookies]=useCookies(['user'])\r\n    let [ticket,setTicket]=useState('')\r\n    let [ticketDetails,setTicketDetails]=useState('')\r\n    let [searchStatus,setSearchStatus]=useState('')\r\n    let [payStatus,setPayStatus]=useState('')\r\n    let [searchSuccessful,setSearchSuccessful]=useState(false)\r\n    let paymentDetails={}\r\n  \r\n\r\n if(IsLoggedIn(cookies)==true){\r\n\r\n        return(\r\n        \r\n        <div style={{padding:\"5px\"}}>\r\n    <div class=\"row\">\r\n        <div class=\"col-md-3\"></div>\r\n        <div class=\"col-md-6\">\r\n            <div class=\"label\">Make payment</div>\r\n            <div class=\"description\">Pay for a service or ticket. Enter the ID, search and pay</div>  \r\n            <div style={{textAlign:\"center\",paddingTop:\"20px\"}}><a href=\"/pages/payments/paymentshomepage\">\r\n                    <div class=\"button1\">Back to menu</div></a></div><p></p>\r\n    \r\n            <form  method=\"post\" id=\"makePaymentForm\" action=\"#\">\r\n          \r\n            <div class=\"formInputLabel\">Search for ticket/service ID (name of ticket) before paying</div>\r\n          <input type=\"text\" name='ticketId' class=\"form-control\" placeholder='Enter ticket ID or name and search' autoComplete=\"off\" /><p></p>\r\n          \r\n          \r\n          \r\n    \r\n    \r\n    <div class=\"status\">{searchStatus}</div>\r\n    \r\n          <div  class=\"button1\"\r\n          \r\n          onClick={()=>{\r\n            let form=document.getElementById('makePaymentForm'),ticketId=form.ticketId.value.trim()\r\n            \r\n            if(Array.from(ticketId).length<1){\r\n    \r\n        \r\n                ToastAlert('toastAlert2','Enter a ticket Id',3000)\r\n            } else{\r\n                setSearchStatus('Please wait...')\r\n            Post('/getTicketDetails',{ticketId:ticketId}).then(resp=>{\r\n                \r\n                if(resp.length==0){\r\n                    setSearchStatus('Ticket/service ID does not exist')\r\n                }else{\r\n                    setSearchStatus('')\r\n    let ticketDetails=resp\r\n    setTicketDetails(resp[0])\r\n    setTicket(ticketDetails.map((ticket)=>(\r\n    <div>\r\n    \r\n    <div>\r\n    <div style={{fontSize:\"20px\",fontWeight:\"600\"}}>{ticket.ticketId}</div>\r\n    <div style={{fontSize:\"14px\"}}>Amount: {ticket.amount +' shs'}</div>\r\n    <div style={{fontSize:\"14px\"}}>Tickets left: {ticket.noOfTickets - ticket.payments.length}</div>\r\n    <div style={{fontSize:\"14px\"}}>Contact: 0{ticket.ticketOwner}</div>\r\n    </div>\r\n    \r\n    </div>\r\n    )))\r\n    setSearchSuccessful(true)\r\n    \r\n                }\r\n    \r\n    \r\n            })\r\n            }\r\n            \r\n           \r\n    \r\n    \r\n    \r\n          }}\r\n          >Search</div>\r\n                            \r\n                 <div style={{paddingTop:\"10px\",paddingBottom:\"3px\"}}> {ticket} </div>\r\n    <p></p>\r\n    <div class=\"formInputLabel\">Create your payment secret code or word (You will be asked for this secret to confirm your payment)</div>\r\n                 <input type=\"text\" name='paymentSecretCode' class=\"form-control\" autoComplete=\"off\" /><p></p>\r\n    <div class=\"status\">{payStatus}</div>\r\n           <div   class=\"button1\"\r\n           onClick={()=>{\r\n         \r\n                \r\n            let form=document.getElementById('makePaymentForm'),paymentSecretCode=form.paymentSecretCode.value.trim()\r\n            if(searchSuccessful===false){\r\n                ToastAlert('toastAlert2','Search before making a payment',3000)\r\n            }else{\r\n    \r\n    paymentDetails.ticketId=ticketDetails.ticketId\r\n    paymentDetails.amount=ticketDetails.amount\r\n    paymentDetails.name=cookies.user.name\r\n    paymentDetails.paymentApproved=false\r\n    paymentDetails.paymentSettled=false\r\n    paymentDetails.contact=cookies.user.contact\r\n    if(Array.from(paymentSecretCode).length<3){\r\n        ToastAlert('toastAlert2','Create a payment secret code of atleast 3 characters',4000)\r\n    }else{\r\n        setPayStatus('Please wait......')\r\n        paymentDetails.paymentSecretCode=paymentSecretCode\r\n        \r\n        GetTradingDetails(cookies.user.contact).then(traderDetails=>{\r\n            \r\n            if(traderDetails.accBal<paymentDetails.amount){\r\n    \r\n                setPayStatus('Kayas account balance is low. Tap menu to deposit to your Kayas account')\r\n            }else{\r\n    \r\n                setPayStatus('Paying........')\r\n                Post('/payForTicket',paymentDetails).then(resp=>{\r\n                    setPayStatus(resp.msg)\r\n                })\r\n    \r\n            }\r\n           \r\n\r\n\r\n        })\r\n    }\r\n            }\r\n           \r\n            \r\n           }}\r\n           \r\n           >Pay now</div><p></p>\r\n          \r\n           </form>\r\n    \r\n         \r\n    \r\n        </div>\r\n        <div class=\"col-md-3\"></div>\r\n    </div>\r\n        </div>)\r\n\r\n }else{\r\nreturn (\r\n    <div>\r\n        <LoginPage/>\r\n    </div>\r\n)\r\n }\r\n\r\n\r\n\r\n\r\n\r\n}\r\n\r\nexport default MakePayment"],"names":["MakePayment","cookies","useCookies","ticket","setTicket","useState","ticketDetails","setTicketDetails","searchStatus","setSearchStatus","payStatus","setPayStatus","searchSuccessful","setSearchSuccessful","paymentDetails","IsLoggedIn","_jsx","style","padding","children","_jsxs","class","textAlign","paddingTop","href","method","id","action","type","name","placeholder","autoComplete","onClick","ticketId","document","getElementById","value","trim","Array","from","length","ToastAlert","Post","then","resp","map","fontSize","fontWeight","amount","noOfTickets","payments","ticketOwner","paddingBottom","paymentSecretCode","user","paymentApproved","paymentSettled","contact","GetTradingDetails","traderDetails","accBal","msg","LoginPage"],"sourceRoot":""}